model Product {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  category    Category
  isAvailable Boolean  @default(true) @map("is_available")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  defaultVariant   ProductVariant? @relation("DefaultVariant", fields: [defaultVariantId], references: [id])
  defaultVariantId Int?            @unique

  variants ProductVariant[]
  Review   Review[]

  @@index([category])
  @@map("product")
}

model ProductVariant {
  id        Int     @id @default(autoincrement())
  product   Product @relation(fields: [productId], references: [id])
  productId Int     @map("product_id")
  color     String
  size      String
  price     Float?
  stock     Int

  images    ProductImage[]
  CartItem  CartItem[]
  OrderItem OrderItem[]

  defaultForProduct Product? @relation("DefaultVariant")

  @@map("product_variant")
}

model ProductImage {
  id        Int             @id @default(autoincrement())
  url       String
  type      ImageType
  alt       String?
  variant   ProductVariant? @relation(fields: [variantId], references: [id])
  variantId Int?

  @@map("product_image")
}
